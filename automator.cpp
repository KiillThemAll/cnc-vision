#include "automator.h"
#include <math.h>

Automator::Automator(QObject *parent) : QObject(parent)
{
    m_working = false;
    m_enabled = false;
    m_mcConnected = false;
    m_cameraConnected = false;
    m_lastdzValid = false;
    m_lastCoordsValid = false;
    m_message = "Waiting for pause";
    m_cutModeEnabled = false;
    m_autosendPower = false;
    m_minPower = 1.0;
    m_maxPower = 0.8;
    m_lastSentPower = 0.0;
    m_powerTimer.setInterval(1000); // maximum power update rate [ms]
    m_powerTimer.setSingleShot(true);

    m_mcs_x_check_state = 0;
    m_mcs_y_check_state = 0;
    m_compensatorOneShot = false;
    m_scanOneShot = false;

    m_surfaceModel = new SurfaceModel(this);

    m_state = Disabled;

    m_scanComplited = false;

    m_surfaceSpline = nullptr;
}

Automator::~Automator()
{
    delete m_surfaceSpline;
}

bool Automator::working() const
{
    return m_working;
}

void Automator::ondzChanged(float dz)
{
    m_lastdz = dz;
}

void Automator::ondzValidChanged(bool valid)
{
    m_lastdzValid = valid;
    m_cameraConnected = valid;
    checkWorkingState();
}

void Automator::onMcConnectionStateChanged(bool connected)
{
    m_mcConnected = connected;
    checkWorkingState();
}

void Automator::onRayConnectionStateChanged(bool connected)
{
    m_lastCoordsValid = connected;
}

void Automator::onCoordsChanged(float x, float y, float z, float b)
{
    Q_UNUSED(z);
    m_mcs_x = x;
    m_mcs_y = y;
    m_mcs_b = b;

    if (!m_autosendPower)
        return;

    if (m_maxPower < m_minPower)
        return;

    if (m_powerTimer.isActive())
        return;

    const float maxX = 2200;
    const float minX = 600;
    const float maxY = 1500;
    const float minY = 0;
    const float dPower = 0.01;
    float airPathLength = (maxX - m_mcs_x) + (maxY - m_mcs_y);
    const float maximumAirPathLength = (maxX - minX) + (maxY - minY);
    float powerSpan = m_maxPower - m_minPower;
    float dist = airPathLength / maximumAirPathLength;
    float targetPower = m_minPower + powerSpan * dist;

    if (fabs(targetPower - m_lastSentPower) < dPower)
        return;

    m_lastSentPower = targetPower;
    emit changePower(m_lastSentPower / 5.0);

    m_powerTimer.start();
}

void Automator::onMcStateChanged(RayReceiver::State s)
{
    if (!m_working)
        return;
    if (s == RayReceiver::Paused) {
        if(m_mcs_x_check_state != m_mcs_x || m_mcs_y_check_state != m_mcs_y)
        {
           m_mcs_x_check_state = m_mcs_x;
           m_mcs_y_check_state = m_mcs_y;
           return;
        }

        if (!m_compensatorOneShot)
        {
            QTimer::singleShot(1000, this, SLOT(compensate()));
            m_compensatorOneShot = true;
        }
    }
    if (s == RayReceiver::Playing)
        m_compensatorOneShot = false;
}

void Automator::onCameraStateChanged(CaptureController::Status s)
{
    if (s == CaptureController::Status::Stopped)
    {
        m_cameraConnected = false;
        checkWorkingState();
    }

}

void Automator::compensate()
{
    if (!m_working || m_cutModeEnabled)
        return;
    float compensated = compensate(m_lastdz);
    if (compensated > 10) {
        m_message = "No entry in comp table";
        emit messageChanged();
    } else {
        float targetB = compensated;
        QString correction = QString("G90 G0 B%1\n").arg(targetB);
        m_message = correction;
        emit messageChanged();
        qDebug() << correction;
        emit sendToMC(correction);
        emit sendToMC("M24\n");
    }
}

void Automator::scanSnapshot(GcodePlayer::State s)
{
    if (s == GcodePlayer::State::PausedM25)
    {
        QTimer::singleShot(1000, this, SLOT(m_scanSnapshot()));
    }
}

void Automator::scanFinished(GcodePlayer::State s)
{
    if (s == GcodePlayer::State::Stopped && m_state == Scanning)
    {

            delete m_surfaceSpline;

            /*m_surfaceSpline = new SPLINTER::BSpline(SPLINTER::BSpline::Builder(m_samples).degree(3).build());

            QVector<SurfacePoint> points;
            SurfacePoint point;
            SPLINTER::DenseVector x(2);

            points.reserve((m_scanWidth+1)*(m_scanHeight+1));

            for(int i = 0; i <= m_scanHeight; i++)
                {
                    for(int j = 0; j <= m_scanWidth; j++)
                    {
                        x(0) = i;
                        point.x = i;
                        x(1) = j;
                        point.y = j;
                        point.z = m_surfaceSpline->eval(x);

                        points.append(point);
                    }
                }

            m_surfaceModel->updatePoints(points);

            m_scanComplited = true;
            emit scanStateChanged();

            m_state = m_cutModeEnabled ? AutoCutting : AutoEngraving;
            emit stateChanged(m_state);*/
    }
}

float Automator::compensate(float dz) const
{
    //                   CAM     ERROR
    const float map[] = {175,	3.38165284430849,
                         174.9,	3.38046377510186,
                         174.8,	3.37927293232817,
                         174.7,	3.37808032399545,
                         174.6,	3.37688595809743,
                         174.5,	3.37568984261349,
                         174.4,	3.37449198550872,
                         174.3,	3.37329239473384,
                         174.2,	3.37209107822526,
                         174.1,	3.37088804390506,
                         174,	3.36968329968101,
                         173.9,	3.36847685344653,
                         173.8,	3.36726871308072,
                         173.7,	3.36605888644836,
                         173.6,	3.36484738139988,
                         173.5,	3.36363420577142,
                         173.4,	3.36241936738475,
                         173.3,	3.36120287404735,
                         173.2,	3.35998473355235,
                         173.1,	3.35876495367856,
                         173,	3.35754354219046,
                         172.9,	3.35632050683821,
                         172.8,	3.35509585535763,
                         172.7,	3.35386959547021,
                         172.6,	3.35264173488315,
                         172.5,	3.35141228128927,
                         172.4,	3.35018124236709,
                         172.3,	3.34894862578081,
                         172.2,	3.34771443918029,
                         172.1,	3.34647869020106,
                         172,	3.34524138646432,
                         171.9,	3.34400253557697,
                         171.8,	3.34276214513155,
                         171.7,	3.34152022270629,
                         171.6,	3.34027677586508,
                         171.5,	3.3390318121575,
                         171.4,	3.33778533911879,
                         171.3,	3.33653736426986,
                         171.2,	3.33528789511731,
                         171.1,	3.33403693915339,
                         171,	3.33278450385604,
                         170.9,	3.33153059668886,
                         170.8,	3.33027522510114,
                         170.7,	3.32901839652781,
                         170.6,	3.32776011838952,
                         170.5,	3.32650039809255,
                         170.4,	3.32523924302887,
                         170.3,	3.32397666057612,
                         170.2,	3.32271265809763,
                         170.1,	3.32144724294237,
                         170,	3.32018042244501,
                         169.9,	3.31891220392587,
                         169.8,	3.31764259469097,
                         169.7,	3.31637160203197,
                         169.6,	3.31509923322624,
                         169.5,	3.31382549553678,
                         169.4,	3.3125503962123,
                         169.3,	3.31127394248717,
                         169.2,	3.30999614158142,
                         169.1,	3.30871700070076,
                         169,	3.30743652703659,
                         168.9,	3.30615472776596,
                         168.8,	3.3048716100516,
                         168.7,	3.30358718104192,
                         168.6,	3.30230144787098,
                         168.5,	3.30101441765855,
                         168.4,	3.29972609751003,
                         168.3,	3.29843649451653,
                         168.2,	3.2971456157548,
                         168.1,	3.29585346828729,
                         168,	3.29456005916212,
                         167.9,	3.29326539541305,
                         167.8,	3.29196948405956,
                         167.7,	3.29067233210676,
                         167.6,	3.28937394654547,
                         167.5,	3.28807433435215,
                         167.4,	3.28677350248895,
                         167.3,	3.28547145790369,
                         167.2,	3.28416820752987,
                         167.1,	3.28286375828665,
                         167,	3.28155811707886,
                         166.9,	3.28025129079701,
                         166.8,	3.2789432863173,
                         166.7,	3.27763411050157,
                         166.6,	3.27632377019735,
                         166.5,	3.27501227223784,
                         166.4,	3.27369962344191,
                         166.3,	3.27238583061412,
                         166.2,	3.27107090054467,
                         166.1,	3.26975484000946,
                         166,	3.26843765577006,
                         165.9,	3.26711935457369,
                         165.8,	3.26579994315326,
                         165.7,	3.26447942822737,
                         165.6,	3.26315781650025,
                         165.5,	3.26183511466185,
                         165.4,	3.26051132938774,
                         165.3,	3.25918646733922,
                         165.2,	3.25786053516322,
                         165.1,	3.25653353949235,
                         165,	3.25520548694491,
                         164.9,	3.25387638412487,
                         164.8,	3.25254623762184,
                         164.7,	3.25121505401115,
                         164.6,	3.24988283985377,
                         164.5,	3.24854960169635,
                         164.4,	3.24721534607121,
                         164.3,	3.24588007949637,
                         164.2,	3.24454380847547,
                         164.1,	3.24320653949788,
                         164,	3.24186827903859,
                         163.9,	3.24052903355831,
                         163.8,	3.23918880950339,
                         163.7,	3.23784761330586,
                         163.6,	3.23650545138343,
                         163.5,	3.23516233013948,
                         163.4,	3.23381825596306,
                         163.3,	3.23247323522889,
                         163.2,	3.23112727429736,
                         163.1,	3.22978037951456,
                         163,	3.22843255721221,
                         162.9,	3.22708381370773,
                         162.8,	3.22573415530421,
                         162.7,	3.22438358829041,
                         162.6,	3.22303211894075,
                         162.5,	3.22167975351535,
                         162.4,	3.22032649825997,
                         162.3,	3.21897235940608,
                         162.2,	3.21761734317078,
                         162.1,	3.21626145575688,
                         162,	3.21490470335284,
                         161.9,	3.2135470921328,
                         161.8,	3.21218862825658,
                         161.7,	3.21082931786966,
                         161.6,	3.20946916710319,
                         161.5,	3.20810818207401,
                         161.4,	3.20674636888461,
                         161.3,	3.20538373362319,
                         161.2,	3.20402028236357,
                         161.1,	3.20265602116529,
                         161,	3.20129095607353,
                         160.9,	3.19992509311917,
                         160.8,	3.19855843831873,
                         160.7,	3.19719099767444,
                         160.6,	3.19582277717417,
                         160.5,	3.19445378279147,
                         160.4,	3.19308402048559,
                         160.3,	3.19171349620142,
                         160.2,	3.19034221586954,
                         160.1,	3.18897018540618,
                         160,	3.18759741071328,
                         159.9,	3.18622389767841,
                         159.8,	3.18484965217485,
                         159.7,	3.18347468006153,
                         159.6,	3.18209898718307,
                         159.5,	3.18072257936974,
                         159.4,	3.17934546243749,
                         159.3,	3.17796764218796,
                         159.2,	3.17658912440845,
                         159.1,	3.17520991487193,
                         159,	3.17383001933703,
                         158.9,	3.17244944354809,
                         158.8,	3.17106819323509,
                         158.7,	3.16968627411369,
                         158.6,	3.16830369188523,
                         158.5,	3.16692045223672,
                         158.4,	3.16553656084084,
                         158.3,	3.16415202335593,
                         158.2,	3.16276684542603,
                         158.1,	3.16138103268084,
                         158,	3.15999459073572,
                         157.9,	3.15860752519173,
                         157.8,	3.15721984163556,
                         157.7,	3.15583154563962,
                         157.6,	3.15444264276197,
                         157.5,	3.15305313854634,
                         157.4,	3.15166303852213,
                         157.3,	3.15027234820442,
                         157.2,	3.14888107309398,
                         157.1,	3.14748921867721,
                         157,	3.14609679042622,
                         156.9,	3.14470379379878,
                         156.8,	3.14331023423833,
                         156.7,	3.14191611717399,
                         156.6,	3.14052144802053,
                         156.5,	3.13912623217843,
                         156.4,	3.13773047503381,
                         156.3,	3.13633418195848,
                         156.2,	3.13493735830992,
                         156.1,	3.13354000943127,
                         156,	3.13214214065137,
                         155.9,	3.1307437572847,
                         155.8,	3.12934486463143,
                         155.7,	3.12794546797741,
                         155.6,	3.12654557259415,
                         155.5,	3.12514518373883,
                         155.4,	3.12374430665431,
                         155.3,	3.12234294656912,
                         155.2,	3.12094110869747,
                         155.1,	3.11953879823923,
                         155,	3.11813602037996,
                         154.9,	3.11673278029087,
                         154.8,	3.11532908312885,
                         154.7,	3.11392493403648,
                         154.6,	3.11252033814199,
                         154.5,	3.1111153005593,
                         154.4,	3.10970982638798,
                         154.3,	3.10830392071331,
                         154.2,	3.1068975886062,
                         154.1,	3.10549083512325,
                         154,	3.10408366530675,
                         153.9,	3.10267608418464,
                         153.8,	3.10126809677054,
                         153.7,	3.09985970806374,
                         153.6,	3.09845092304921,
                         153.5,	3.09704174669759,
                         153.4,	3.09563218396518,
                         153.3,	3.09422223979397,
                         153.2,	3.09281191911162,
                         153.1,	3.09140122683144,
                         153,	3.08999016785246,
                         152.9,	3.08857874705933,
                         152.8,	3.0871669693224,
                         152.7,	3.08575483949769,
                         152.6,	3.0843423624269,
                         152.5,	3.08292954293738,
                         152.4,	3.08151638584218,
                         152.3,	3.08010289594,
                         152.2,	3.07868907801522,
                         152.1,	3.0772749368379,
                         152,	3.07586047716376,
                         151.9,	3.0744457037342,
                         151.8,	3.07303062127631,
                         151.7,	3.0716152345028,
                         151.6,	3.07019954811212,
                         151.5,	3.06878356678835,
                         151.4,	3.06736729520124,
                         151.3,	3.06595073800624,
                         151.2,	3.06453389984444,
                         151.1,	3.06311678534265,
                         151,	3.06169939911329,
                         150.9,	3.0602817457545,
                         150.8,	3.05886382985008,
                         150.7,	3.0574456559695,
                         150.6,	3.0560272286679,
                         150.5,	3.05460855248609,
                         150.4,	3.05318963195057,
                         150.3,	3.0517704715735,
                         150.2,	3.0503510758527,
                         150.1,	3.04893144927169,
                         150,	3.04751159629964,
                         149.9,	3.04609152139141,
                         149.8,	3.04467122898752,
                         149.7,	3.04325072351416,
                         149.6,	3.0418300093832,
                         149.5,	3.0404090909922,
                         149.4,	3.03898797272435,
                         149.3,	3.03756665894855,
                         149.2,	3.03614515401935,
                         149.1,	3.03472346227699,
                         149,	3.03330158804738,
                         148.9,	3.03187953564208,
                         148.8,	3.03045730935836,
                         148.7,	3.02903491347913,
                         148.6,	3.02761235227298,
                         148.5,	3.02618962999419,
                         148.4,	3.0247667508827,
                         148.3,	3.02334371916411,
                         148.2,	3.02192053904971,
                         148.1,	3.02049721473647,
                         148,	3.01907375040701,
                         147.9,	3.01765015022963,
                         147.8,	3.01622641835831,
                         147.7,	3.01480255893271,
                         147.6,	3.01337857607813,
                         147.5,	3.01195447390557,
                         147.4,	3.01053025651171,
                         147.3,	3.00910592797887,
                         147.2,	3.00768149237507,
                         147.1,	3.006256953754,
                         147,	3.00483231615501,
                         146.9,	3.00340758360312,
                         146.8,	3.00198276010905,
                         146.7,	3.00055784966916,
                         146.6,	2.9991328562655,
                         146.5,	2.9977077838658,
                         146.4,	2.99628263642344,
                         146.3,	2.99485741787748,
                         146.2,	2.99343213215268,
                         146.1,	2.99200678315942,
                         146,	2.99058137479381,
                         145.9,	2.98915591093759,
                         145.8,	2.98773039545819,
                         145.7,	2.98630483220871,
                         145.6,	2.98487922502792,
                         145.5,	2.98345357774028,
                         145.4,	2.98202789415589,
                         145.3,	2.98060217807055,
                         145.2,	2.97917643326572,
                         145.1,	2.97775066350854,
                         145,	2.97632487255181,
                         144.9,	2.97489906413402,
                         144.8,	2.97347324197932,
                         144.7,	2.97204740979754,
                         144.6,	2.97062157128417,
                         144.5,	2.96919573012039,
                         144.4,	2.96776988997304,
                         144.3,	2.96634405449463,
                         144.2,	2.96491822732337,
                         144.1,	2.9634924120831,
                         144,	2.96206661238336,
                         143.9,	2.96064083181937,
                         143.8,	2.95921507397199,
                         143.7,	2.95778934240779,
                         143.6,	2.95636364067898,
                         143.5,	2.95493797232346,
                         143.4,	2.95351234086481,
                         143.3,	2.95208674981227,
                         143.2,	2.95066120266074,
                         143.1,	2.94923570289083,
                         143,	2.94781025396878,
                         142.9,	2.94638485934654,
                         142.8,	2.9449595224617,
                         142.7,	2.94353424673756,
                         142.6,	2.94210903558304,
                         142.5,	2.94068389239279,
                         142.4,	2.9392588205471,
                         142.3,	2.93783382341193,
                         142.2,	2.93640890433892,
                         142.1,	2.9349840666654,
                         142,	2.93355931371434,
                         141.9,	2.9321346487944,
                         141.8,	2.93071007519992,
                         141.7,	2.92928559621091,
                         141.6,	2.92786121509303,
                         141.5,	2.92643693509763,
                         141.4,	2.92501275946175,
                         141.3,	2.92358869140806,
                         141.2,	2.92216473414495,
                         141.1,	2.92074089086645,
                         141,	2.91931716475226,
                         140.9,	2.91789355896779,
                         140.8,	2.91647007666408,
                         140.7,	2.91504672097786,
                         140.6,	2.91362349503154,
                         140.5,	2.91220040193319,
                         140.4,	2.91077744477657,
                         140.3,	2.90935462664108,
                         140.2,	2.90793195059182,
                         140.1,	2.90650941967957,
                         140,	2.90508703694075,
                         139.9,	2.90366480539748,
                         139.8,	2.90224272805755,
                         139.7,	2.9008208079144,
                         139.6,	2.89939904794716,
                         139.5,	2.89797745112065,
                         139.4,	2.89655602038532,
                         139.3,	2.89513475867734,
                         139.2,	2.89371366891851,
                         139.1,	2.89229275401633,
                         139,	2.89087201686396,
                         138.9,	2.88945146034024,
                         138.8,	2.88803108730968,
                         138.7,	2.88661090062246,
                         138.6,	2.88519090311443,
                         138.5,	2.88377109760713,
                         138.4,	2.88235148690775,
                         138.3,	2.88093207380917,
                         138.2,	2.87951286108992,
                         138.1,	2.87809385151423,
                         138,	2.87667504783199,
                         137.9,	2.87525645277876,
                         137.8,	2.87383806907577,
                         137.7,	2.87241989942994,
                         137.6,	2.87100194653384,
                         137.5,	2.86958421306573,
                         137.4,	2.86816670168953,
                         137.3,	2.86674941505485,
                         137.2,	2.86533235579694,
                         137.1,	2.86391552653676,
                         137,	2.86249892988092,
                         136.9,	2.86108256842171,
                         136.8,	2.8596664447371,
                         136.7,	2.85825056139071,
                         136.6,	2.85683492093185,
                         136.5,	2.8554195258955,
                         136.4,	2.85400437880232,
                         136.3,	2.85258948215862,
                         136.2,	2.85117483845641,
                         136.1,	2.84976045017335,
                         136,	2.84834631977278,
                         135.9,	2.84693244970373,
                         135.8,	2.84551884240087,
                         135.7,	2.84410550028458,
                         135.6,	2.84269242576087,
                         135.5,	2.84127962122145,
                         135.4,	2.83986708904371,
                         135.3,	2.83845483159069,
                         135.2,	2.83704285121112,
                         135.1,	2.83563115023939,
                         135,	2.83421973099557,
                         134.9,	2.83280859578539,
                         134.8,	2.83139774690028,
                         134.7,	2.82998718661732,
                         134.6,	2.82857691719927,
                         134.5,	2.82716694089455,
                         134.4,	2.82575725993728,
                         134.3,	2.82434787654723,
                         134.2,	2.82293879292984,
                         134.1,	2.82153001127624,
                         134,	2.82012153376322,
                         133.9,	2.81871336255325,
                         133.8,	2.81730549979447,
                         133.7,	2.81589794762069,
                         133.6,	2.81449070815139,
                         133.5,	2.81308378349174,
                         133.4,	2.81167717573255,
                         133.3,	2.81027088695034,
                         133.2,	2.80886491920728,
                         133.1,	2.80745927455121,
                         133,	2.80605395501566,
                         132.9,	2.80464896261981,
                         132.8,	2.80324429936854,
                         132.7,	2.80183996725237,
                         132.6,	2.80043596824753,
                         132.5,	2.79903230431589,
                         132.4,	2.79762897740502,
                         132.3,	2.79622598944812,
                         132.2,	2.79482334236412,
                         132.1,	2.79342103805758,
                         132,	2.79201907841874,
                         131.9,	2.79061746532354,
                         131.8,	2.78921620063354,
                         131.7,	2.78781528619603,
                         131.6,	2.78641472384394,
                         131.5,	2.78501451539587,
                         131.4,	2.78361466265611,
                         131.3,	2.78221516741461,
                         131.2,	2.780816031447,
                         131.1,	2.77941725651458,
                         131,	2.77801884436431,
                         130.9,	2.77662079672885,
                         130.8,	2.77522311532651,
                         130.7,	2.77382580186128,
                         130.6,	2.77242885802283,
                         130.5,	2.77103228548648,
                         130.4,	2.76963608591325,
                         130.3,	2.76824026094981,
                         130.2,	2.76684481222852,
                         130.1,	2.7654497413674,
                         130,	2.76405504997015,
                         129.9,	2.76266073962615,
                         129.8,	2.76126681191043,
                         129.7,	2.75987326838371,
                         129.6,	2.75848011059237,
                         129.5,	2.75708734006849,
                         129.4,	2.75569495832979,
                         129.3,	2.75430296687967,
                         129.2,	2.75291136720723,
                         129.1,	2.7515201607872,
                         129,	2.75012934908001,
                         128.9,	2.74873893353177,
                         128.8,	2.74734891557423,
                         128.7,	2.74595929662483,
                         128.6,	2.74457007808671,
                         128.5,	2.74318126134863,
                         128.4,	2.74179284778506,
                         128.3,	2.74040483875613,
                         128.2,	2.73901723560765,
                         128.1,	2.73763003967109,
                         128,	2.7362432522636,
                         127.9,	2.73485687468801,
                         127.8,	2.73347090823281,
                         127.7,	2.73208535417217,
                         127.6,	2.73070021376592,
                         127.5,	2.72931548825958,
                         127.4,	2.72793117888434,
                         127.3,	2.72654728685706,
                         127.2,	2.72516381338026,
                         127.1,	2.72378075964214,
                         127,	2.72239812681659,
                         126.9,	2.72101591606315,
                         126.8,	2.71963412852704,
                         126.7,	2.71825276533916,
                         126.6,	2.71687182761607,
                         126.5,	2.71549131646001,
                         126.4,	2.71411123295889,
                         126.3,	2.7127315781863,
                         126.2,	2.71135235320149,
                         126.1,	2.70997355904939,
                         126,	2.7085951967606,
                         125.9,	2.7072172673514,
                         125.8,	2.70583977182374,
                         125.7,	2.70446271116523,
                         125.6,	2.70308608634916,
                         125.5,	2.7017098983345,
                         125.4,	2.7003341480659,
                         125.3,	2.69895883647365,
                         125.2,	2.69758396447373,
                         125.1,	2.69620953296782,
                         125,	2.69483554284323,
                         124.9,	2.69346199497295,
                         124.8,	2.69208889021568,
                         124.7,	2.69071622941574,
                         124.6,	2.68934401340317,
                         124.5,	2.68797224299364,
                         124.4,	2.68660091898853,
                         124.3,	2.68523004217487,
                         124.2,	2.68385961332536,
                         124.1,	2.68248963319839,
                         124,	2.68112010253801,
                         123.9,	2.67975102207395,
                         123.8,	2.67838239252161,
                         123.7,	2.67701421458205,
                         123.6,	2.67564648894203,
                         123.5,	2.67427921627395,
                         123.4,	2.67291239723591,
                         123.3,	2.67154603247168,
                         123.2,	2.67018012261067,
                         123.1,	2.66881466826801,
                         123,	2.66744967004446,
                         122.9,	2.66608512852649,
                         122.8,	2.66472104428622,
                         122.7,	2.66335741788144,
                         122.6,	2.66199424985562,
                         122.5,	2.66063154073792,
                         122.4,	2.65926929104313,
                         122.3,	2.65790750127175,
                         122.2,	2.65654617190995,
                         122.1,	2.65518530342955,
                         122,	2.65382489628805,
                         121.9,	2.65246495092865,
                         121.8,	2.65110546778017,
                         121.7,	2.64974644725717,
                         121.6,	2.64838788975981,
                         121.5,	2.64702979567399,
                         121.4,	2.64567216537122,
                         121.3,	2.64431499920874,
                         121.2,	2.64295829752943,
                         121.1,	2.64160206066184,
                         121,	2.6402462889202,
                         120.9,	2.63889098260443,
                         120.8,	2.63753614200009,
                         120.7,	2.63618176737844,
                         120.6,	2.6348278589964,
                         120.5,	2.63347441709656,
                         120.4,	2.63212144190719,
                         120.3,	2.63076893364223,
                         120.2,	2.6294168925013,
                         120.1,	2.62806531866967,
                         120,	2.6267142123183,
                         119.9,	2.62536357360383,
                         119.8,	2.62401340266855,
                         119.7,	2.62266369964044,
                         119.6,	2.62131446463316,
                         119.5,	2.61996569774602,
                         119.4,	2.618617399064,
                         119.3,	2.61726956865779,
                         119.2,	2.61592220658371,
                         119.1,	2.61457531288379,
                         119,	2.61322888758569,
                         118.9,	2.61188293070278,
                         118.8,	2.61053744223408,
                         118.7,	2.60919242216431,
                         118.6,	2.60784787046382,
                         118.5,	2.60650378708867,
                         118.4,	2.60516017198058,
                         118.3,	2.60381702506693,
                         118.2,	2.60247434626079,
                         118.1,	2.60113213546091,
                         118,	2.59979039255168,
                         117.9,	2.59844911740319,
                         117.8,	2.5971083098712,
                         117.7,	2.59576796979712,
                         117.6,	2.59442809700807,
                         117.5,	2.59308869131681,
                         117.4,	2.59174975252179,
                         117.3,	2.59041128040713,
                         117.2,	2.58907327474261,
                         117.1,	2.5877357352837,
                         117,	2.58639866177153,
                         116.9,	2.58506205393292,
                         116.8,	2.58372591148034,
                         116.7,	2.58239023411194,
                         116.6,	2.58105502151156,
                         116.5,	2.57972027334869,
                         116.4,	2.57838598927849,
                         116.3,	2.57705216894182,
                         116.2,	2.57571881196519,
                         116.1,	2.57438591796079,
                         116,	2.57305348652648,
                         115.9,	2.57172151724579,
                         115.8,	2.57039000968793,
                         115.7,	2.56905896340779,
                         115.6,	2.5677283779459,
                         115.5,	2.5663982528285,
                         115.4,	2.56506858756748,
                         115.3,	2.56373938166041,
                         115.2,	2.56241063459054,
                         115.1,	2.56108234582677,
                         115,	2.5597545148237,
                         114.9,	2.55842714102158,
                         114.8,	2.55710022384635,
                         114.7,	2.55577376270962,
                         114.6,	2.55444775700865,
                         114.5,	2.55312220612641,
                         114.4,	2.55179710943151,
                         114.3,	2.55047246627825,
                         114.2,	2.54914827600659,
                         114.1,	2.54782453794218,
                         114,	2.54650125139633,
                         113.9,	2.54517841566603,
                         113.8,	2.54385603003394,
                         113.7,	2.54253409376838,
                         113.6,	2.54121260612335,
                         113.5,	2.53989156633855,
                         113.4,	2.53857097363931,
                         113.3,	2.53725082723665,
                         113.2,	2.53593112632727,
                         113.1,	2.53461187009354,
                         113,	2.5332930577035,
                         112.9,	2.53197468831085,
                         112.8,	2.53065676105498,
                         112.7,	2.52933927506095,
                         112.6,	2.52802222943949,
                         112.5,	2.526705623287,
                         112.4,	2.52538945568555,
                         112.3,	2.52407372570289,
                         112.2,	2.52275843239245,
                         112.1,	2.52144357479331,
                         112,	2.52012915193024,
                         111.9,	2.51881516281368,
                         111.8,	2.51750160643974,
                         111.7,	2.51618848179019,
                         111.6,	2.5148757878325,
                         111.5,	2.5135635235198,
                         111.4,	2.51225168779088,
                         111.3,	2.51094027957022,
                         111.2,	2.50962929776796,
                         111.1,	2.50831874127992,
                         111,	2.5070086089876,
                         110.9,	2.50569889975815,
                         110.8,	2.50438961244442,
                         110.7,	2.50308074588491,
                         110.6,	2.50177229890381,
                         110.5,	2.50046427031096,
                         110.4,	2.49915665890189,
                         110.3,	2.49784946345781,
                         110.2,	2.49654268274559,
                         110.1,	2.49523631551776,
                         110,	2.49393036051255,
                         109.9,	2.49262481645385,
                         109.8,	2.49131968205121,
                         109.7,	2.49001495599988,
                         109.6,	2.48871063698076,
                         109.5,	2.48740672366044,
                         109.4,	2.48610321469115,
                         109.3,	2.48480010871083,
                         109.2,	2.48349740434308,
                         109.1,	2.48219510019717,
                         109,	2.48089319486804,
                         108.9,	2.4795916869363,
                         108.8,	2.47829057496825,
                         108.7,	2.47698985751584,
                         108.6,	2.47568953311671,
                         108.5,	2.47438960029416,
                         108.4,	2.47309005755717,
                         108.3,	2.4717909034004,
                         108.2,	2.47049213630416,
                         108.1,	2.46919375473446,
                         108,	2.46789575714296,
                         107.9,	2.46659814196701,
                         107.8,	2.46530090762961,
                         107.7,	2.46400405253946,
                         107.6,	2.46270757509091,
                         107.5,	2.461411473664,
                         107.4,	2.46011574662443,
                         107.3,	2.45882039232358,
                         107.2,	2.4575254090985,
                         107.1,	2.4562307952719,
                         107,	2.45493654915219,
                         106.9,	2.45364266903343,
                         106.8,	2.45234915319537,
                         106.7,	2.45105599990341,
                         106.6,	2.44976320740864,
                         106.5,	2.44847077394782,
                         106.4,	2.44717869774337,
                         106.3,	2.44588697700341,
                         106.2,	2.44459560992171,
                         106.1,	2.44330459467771,
                         106,	2.44201392943654,
                         105.9,	2.44072361234899,
                         105.8,	2.43943364155153,
                         105.7,	2.43814401516629,
                         105.6,	2.43685473130108,
                         105.5,	2.4355657880494,
                         105.4,	2.43427718349039,
                         105.3,	2.43298891568889,
                         105.2,	2.4317009826954,
                         105.1,	2.43041338254608,
                         105,	2.4291261132628,
                         104.9,	2.42783917285306,
                         104.8,	2.42655255931006,
                         104.7,	2.42526627061267,
                         104.6,	2.42398030472541,
                         104.5,	2.42269465959851,
                         104.4,	2.42140933316784,
                         104.3,	2.42012432335497,
                         104.2,	2.4188396280671,
                         104.1,	2.41755524519716,
                         104,	2.4162711726237,
                         103.9,	2.41498740821097,
                         103.8,	2.4137039498089,
                         103.7,	2.41242079525308,
                         103.6,	2.41113794236476,
                         103.5,	2.40985538895088,
                         103.4,	2.40857313280405,
                         103.3,	2.40729117170255,
                         103.2,	2.40600950341034,
                         103.1,	2.40472812567704,
                         103,	2.40344703623795,
                         102.9,	2.40216623281404,
                         102.8,	2.40088571311195,
                         102.7,	2.39960547482401,
                         102.6,	2.39832551562819,
                         102.5,	2.39704583318817,
                         102.4,	2.39576642515328,
                         102.3,	2.39448728915852,
                         102.2,	2.39320842282457,
                         102.1,	2.39192982375779,
                         102,	2.3906514895502,
                         101.9,	2.3893734177795,
                         101.8,	2.38809560600905,
                         101.7,	2.3868180517879,
                         101.6,	2.38554075265077,
                         101.5,	2.38426370611804,
                         101.4,	2.38298690969578,
                         101.3,	2.38171036087571,
                         101.2,	2.38043405713524,
                         101.1,	2.37915799593745,
                         101,	2.37788217473109,
                         100.9,	2.37660659095058,
                         100.8,	2.37533124201602,
                         100.7,	2.37405612533318,
                         100.6,	2.3727812382935,
                         100.5,	2.37150657827409,
                         100.4,	2.37023214263774,
                         100.3,	2.3689579287329,
                         100.2,	2.36768393389372,
                         100.1,	2.36641015543998,
                         100,	2.36513659067718,
                         99.9,	2.36386323689645,
                         99.8,	2.36259009137463,
                         99.7,	2.3613171513742,
                         99.6,	2.36004441414333,
                         99.5,	2.35877187691586,
                         99.4,	2.35749953691131,
                         99.3,	2.35622739133486,
                         99.2,	2.35495543737736,
                         99.1,	2.35368367221534,
                         99,	2.35241209301102,
                         98.9,	2.35114069691226,
                         98.8,	2.34986948105261,
                         98.7,	2.34859844255129,
                         98.6,	2.3473275785132,
                         98.5,	2.34605688602889,
                         98.4,	2.34478636217462,
                         98.3,	2.34351600401228,
                         98.2,	2.34224580858947,
                         98.1,	2.34097577293943,
                         98,	2.33970589408111,
                         97.9,	2.33843616901909,
                         97.8,	2.33716659474365,
                         97.7,	2.33589716823074,
                         97.6,	2.33462788644198,
                         97.5,	2.33335874632465,
                         97.4,	2.33208974481173,
                         97.3,	2.33082087882185,
                         97.2,	2.32955214525932,
                         97.1,	2.32828354101412,
                         97,	2.3270150629619,
                         96.9,	2.325746707964,
                         96.8,	2.32447847286741,
                         96.7,	2.3232103545048,
                         96.6,	2.32194234969452,
                         96.5,	2.32067445524059,
                         96.4,	2.31940666793269,
                         96.3,	2.3181389845462,
                         96.2,	2.31687140184214,
                         96.1,	2.31560391656722,
                         96,	2.31433652545382,
                         95.9,	2.31306922522,
                         95.8,	2.31180201256949,
                         95.7,	2.31053488419167,
                         95.6,	2.30926783676162,
                         95.5,	2.30800086694009,
                         95.4,	2.30673397137349,
                         95.3,	2.30546714669391,
                         95.2,	2.3042003895191,
                         95.1,	2.30293369645251,
                         95,	2.30166706408325,
                         94.9,	2.30040048898608,
                         94.8,	2.29913396772146,
                         94.7,	2.29786749683552,
                         94.6,	2.29660107286005,
                         94.5,	2.29533469231252,
                         94.4,	2.29406835169608,
                         94.3,	2.29280204749953,
                         94.2,	2.29153577619737,
                         94.1,	2.29026953424975,
                         94,	2.28900331810251,
                         93.9,	2.28773712418716,
                         93.8,	2.28647094892086,
                         93.7,	2.28520478870647,
                         93.6,	2.28393863993252,
                         93.5,	2.2826724989732,
                         93.4,	2.28140636218837,
                         93.3,	2.28014022592358,
                         93.2,	2.27887408651004,
                         93.1,	2.27760794026463,
                         93,	2.27634178348992,
                         92.9,	2.27507561247413,
                         92.8,	2.27380942349118,
                         92.7,	2.27254321280062,
                         92.6,	2.27127697664772,
                         92.5,	2.2700107112634,
                         92.4,	2.26874441286424,
                         92.3,	2.26747807765252,
                         92.2,	2.26621170181618,
                         92.1,	2.26494528152881,
                         92,	2.26367881294972,
                         91.9,	2.26241229222386,
                         91.8,	2.26114571548186,
                         91.7,	2.25987907884001,
                         91.6,	2.25861237840029,
                         91.5,	2.25734561025036,
                         91.4,	2.25607877046353,
                         91.3,	2.25481185509879,
                         91.2,	2.25354486020081,
                         91.1,	2.25227778179992,
                         91,	2.25101061591214,
                         90.9,	2.24974335853915,
                         90.8,	2.24847600566831,
                         90.7,	2.24720855327264,
                         90.6,	2.24594099731084,
                         90.5,	2.24467333372728,
                         90.4,	2.24340555845202,
                         90.3,	2.24213766740077,
                         90.2,	2.24086965647492,
                         90.1,	2.23960152156154,
                         90,	2.23833325853336,
                         89.9,	2.23706486324879,
                         89.8,	2.2357963315519,
                         89.7,	2.23452765927247,
                         89.6,	2.23325884222591,
                         89.5,	2.23198987621332,
                         89.4,	2.23072075702147,
                         89.3,	2.22945148042281,
                         89.2,	2.22818204217546,
                         89.1,	2.2269124380232,
                         89,	2.2256426636955,
                         88.9,	2.22437271490749,
                         88.8,	2.22310258735997,
                         88.7,	2.22183227673944,
                         88.6,	2.22056177871803,
                         88.5,	2.21929108895359,
                         88.4,	2.2180202030896,
                         88.3,	2.21674911675523,
                         88.2,	2.21547782556533,
                         88.1,	2.21420632512041,
                         88,	2.21293461100666,
                         87.9,	2.21166267879595,
                         87.8,	2.2103905240458,
                         87.7,	2.20911814229942,
                         87.6,	2.20784552908569,
                         87.5,	2.20657267991917,
                         87.4,	2.20529959030006,
                         87.3,	2.20402625571428,
                         87.2,	2.20275267163339,
                         87.1,	2.20147883351463,
                         87,	2.20020473680091,
                         86.9,	2.19893037692083,
                         86.8,	2.19765574928863,
                         86.7,	2.19638084930427,
                         86.6,	2.19510567235332,
                         86.5,	2.19383021380709,
                         86.4,	2.19255446902251,
                         86.3,	2.1912784333422,
                         86.2,	2.19000210209447,
                         86.1,	2.18872547059327,
                         86,	2.18744853413826,
                         85.9,	2.18617128801473,
                         85.8,	2.18489372749369,
                         85.7,	2.18361584783177,
                         85.6,	2.18233764427133,
                         85.5,	2.18105911204035,
                         85.4,	2.17978024635252,
                         85.3,	2.17850104240717,
                         85.2,	2.17722149538934,
                         85.1,	2.17594160046972,
                         85,	2.17466135280467,
                         84.9,	2.17338074753624,
                         84.8,	2.17209977979212,
                         84.7,	2.17081844468571,
                         84.6,	2.16953673731606,
                         84.5,	2.16825465276791,
                         84.4,	2.16697218611164,
                         84.3,	2.16568933240335,
                         84.2,	2.16440608668477,
                         84.1,	2.16312244398332,
                         84,	2.1618383993121,
                         83.9,	2.16055394766987,
                         83.8,	2.15926908404106,
                         83.7,	2.15798380339579,
                         83.6,	2.15669810068985,
                         83.5,	2.15541197086467,
                         83.4,	2.1541254088474,
                         83.3,	2.15283840955083,
                         83.2,	2.15155096787344,
                         83.1,	2.15026307869936,
                         83,	2.14897473689843,
                         82.9,	2.14768593732612,
                         82.8,	2.1463966748236,
                         82.7,	2.14510694421771,
                         82.6,	2.14381674032096,
                         82.5,	2.14252605793152,
                         82.4,	2.14123489183326,
                         82.3,	2.13994323679569,
                         82.2,	2.13865108757401,
                         82.1,	2.13735843890911,
                         82,	2.13606528552751,
                         81.9,	2.13477162214144,
                         81.8,	2.13347744344878,
                         81.7,	2.13218274413311,
                         81.6,	2.13088751886364,
                         81.5,	2.12959176229529,
                         81.4,	2.12829546906865,
                         81.3,	2.12699863380995,
                         81.2,	2.12570125113113,
                         81.1,	2.12440331562977,
                         81,	2.12310482188916,
                         80.9,	2.12180576447824,
                         80.8,	2.12050613795162,
                         80.7,	2.11920593684958,
                         80.6,	2.11790515569809,
                         80.5,	2.11660378900878,
                         80.4,	2.11530183127896,
                         80.3,	2.11399927699159,
                         80.2,	2.11269612061535,
                         80.1,	2.11139235660454,
                         80,	2.11008797939917,
                         79.9,	2.10878298342489,
                         79.8,	2.10747736309306,
                         79.7,	2.10617111280069,
                         79.6,	2.10486422693046,
                         79.5,	2.10355669985073,
                         79.4,	2.10224852591553,
                         79.3,	2.10093969946457,
                         79.2,	2.09963021482323,
                         79.1,	2.09832006630254,
                         79,	2.09700924819925,
                         78.9,	2.09569775479573,
                         78.8,	2.09438558036005,
                         78.7,	2.09307271914596,
                         78.6,	2.09175916539287,
                         78.5,	2.09044491332586,
                         78.4,	2.08912995715569,
                         78.3,	2.08781429107879,
                         78.2,	2.08649790927726,
                         78.1,	2.08518080591888,
                         78,	2.0838629751571,
                         77.9,	2.08254441113103,
                         77.8,	2.08122510796547,
                         77.7,	2.07990505977088,
                         77.6,	2.0785842606434,
                         77.5,	2.07726270466485,
                         77.4,	2.0759403859027,
                         77.3,	2.07461729841011,
                         77.2,	2.07329343622592,
                         77.1,	2.07196879337461,
                         77,	2.07064336386637,
                         76.9,	2.06931714169705,
                         76.8,	2.06799012084815,
                         76.7,	2.06666229528687,
                         76.6,	2.06533365896608,
                         76.5,	2.06400420582432,
                         76.4,	2.06267392978578,
                         76.3,	2.06134282476036,
                         76.2,	2.06001088464361,
                         76.1,	2.05867810331675,
                         76,	2.05734447464669,
                         75.9,	2.05600999248599,
                         75.8,	2.05467465067291,
                         75.7,	2.05333844303136,
                         75.6,	2.05200136337092,
                         75.5,	2.05066340548687,
                         75.4,	2.04932456316013,
                         75.3,	2.04798483015732,
                         75.2,	2.04664420023072,
                         75.1,	2.04530266711827,
                         75,	2.04396022454361,
                         74.9,	2.04261686621603,
                         74.8,	2.04127258583051,
                         74.7,	2.03992737706768,
                         74.6,	2.03858123359386,
                         74.5,	2.03723414906105,
                         74.4,	2.0358861171069,
                         74.3,	2.03453713135474,
                         74.2,	2.03318718541359,
                         74.1,	2.03183627287812,
                         74,	2.03048438732868,
                         73.9,	2.0291315223313,
                         73.8,	2.02777767143767,
                         73.7,	2.02642282818517,
                         73.6,	2.02506698609683,
                         73.5,	2.02371013868137,
                         73.4,	2.02235227943318,
                         73.3,	2.02099340183232,
                         73.2,	2.01963349934452,
                         73.1,	2.01827256542118,
                         73,	2.01691059349938,
                         72.9,	2.01554757700187,
                         72.8,	2.01418350933708,
                         72.7,	2.0128183838991,
                         72.6,	2.0114521940677,
                         72.5,	2.01008493320831,
                         72.4,	2.00871659467206,
                         72.3,	2.00734717179572,
                         72.2,	2.00597665790176,
                         72.1,	2.00460504629831,
                         72,	2.00323233027917,
                         71.9,	2.00185850312381,
                         71.8,	2.00048355809738,
                         71.7,	1.99910748845072,
                         71.6,	1.9977302874203,
                         71.5,	1.9963519482283,
                         71.4,	1.99497246408255,
                         71.3,	1.99359182817657,
                         71.2,	1.99221003368955,
                         71.1,	1.99082707378633,
                         71,	1.98944294161745,
                         70.9,	1.98805763031911,
                         70.8,	1.98667113301318,
                         70.7,	1.98528344280721,
                         70.6,	1.98389455279443,
                         70.5,	1.98250445605372,
                         70.4,	1.98111314564965,
                         70.3,	1.97972061463245,
                         70.2,	1.97832685603805,
                         70.1,	1.97693186288801,
                         70,	1.9755356281896,
                         69.9,	1.97413814493574,
                         69.8,	1.97273940610503,
                         69.7,	1.97133940466175,
                         69.6,	1.96993813355584,
                         69.5,	1.96853558572293,
                         69.4,	1.9671317540843,
                         69.3,	1.96572663154691,
                         69.2,	1.9643202110034,
                         69.1,	1.96291248533209,
                         69,	1.96150344739694,
                         68.9,	1.96009309004763,
                         68.8,	1.95868140611946,
                         68.7,	1.95726838843345,
                         68.6,	1.95585402979626,
                         68.5,	1.95443832300024,
                         68.4,	1.9530212608234,
                         68.3,	1.95160283602944,
                         68.2,	1.95018304136771,
                         68.1,	1.94876186957326,
                         68,	1.94733931336678,
                         67.9,	1.94591536545466,
                         67.8,	1.94449001852895,
                         67.7,	1.94306326526738,
                         67.6,	1.94163509833334,
                         67.5,	1.94020551037591,
                         67.4,	1.93877449402983,
                         67.3,	1.9373420419155,
                         67.2,	1.93590814663903,
                         67.1,	1.93447280079217,
                         67,	1.93303599695235,
                         66.9,	1.93159772768268,
                         66.8,	1.93015798553195,
                         66.7,	1.92871676303459,
                         66.6,	1.92727405271074,
                         66.5,	1.92582984706618,
                         66.4,	1.9243841385924,
                         66.3,	1.92293691976653,
                         66.2,	1.92148818305138,
                         66.1,	1.92003792089544,
                         66,	1.91858612573287,
                         65.9,	1.91713278998351,
                         65.8,	1.91567790605285,
                         65.7,	1.91422146633207,
                         65.6,	1.91276346319803,
                         65.5,	1.91130388901324,
                         65.4,	1.90984273612591,
                         65.3,	1.90837999686989,
                         65.2,	1.90691566356473,
                         65.1,	1.90544972851564,
                         65,	1.90398218401351,
                         64.9,	1.90251302233489,
                         64.8,	1.90104223574201,
                         64.7,	1.89956981648278,
                         64.6,	1.89809575679078,
                         64.5,	1.89662004888524,
                         64.4,	1.8951426849711,
                         64.3,	1.89366365723894,
                         64.2,	1.89218295786503,
                         64.1,	1.89070057901131,
                         64,	1.88921651282539,
                         63.9,	1.88773075144056,
                         63.8,	1.88624328697576,
                         63.7,	1.88475411153564,
                         63.6,	1.88326321721049,
                         63.5,	1.88177059607628,
                         63.4,	1.88027624019467,
                         63.3,	1.87878014161296,
                         63.2,	1.87728229236416,
                         63.1,	1.87578268446693,
                         63,	1.87428130992561,
                         62.9,	1.87277816073019,
                         62.8,	1.87127322885638,
                         62.7,	1.86976650626552,
                         62.6,	1.86825798490464,
                         62.5,	1.86674765670643,
                         62.4,	1.86523551358929,
                         62.3,	1.86372154745723,
                         62.2,	1.8622057502,
                         62.1,	1.86068811369297,
                         62,	1.85916862979721,
                         61.9,	1.85764729035945,
                         61.8,	1.85612408721211,
                         61.7,	1.85459901217326,
                         61.6,	1.85307205704666,
                         61.5,	1.85154321362173,
                         61.4,	1.85001247367358,
                         61.3,	1.84847982896296,
                         61.2,	1.84694527123634,
                         61.1,	1.84540879222582,
                         61,	1.84387038364919,
                         60.9,	1.84233003720992,
                         60.8,	1.84078774459714,
                         60.7,	1.83924349748565,
                         60.6,	1.83769728753594,
                         60.5,	1.83614910639416,
                         60.4,	1.83459894569212,
                         60.3,	1.83304679704734,
                         60.2,	1.83149265206297,
                         60.1,	1.82993650232787,
                         60,	1.82837833941654,
                         59.9,	1.82681815488918,
                         59.8,	1.82525594029164,
                         59.7,	1.82369168715546,
                         59.6,	1.82212538699784,
                         59.5,	1.82055703132166,
                         59.4,	1.81898661161547,
                         59.3,	1.81741411935349,
                         59.2,	1.81583954599563,
                         59.1,	1.81426288298744,
                         59,	1.81268412176018,
                         58.9,	1.81110325373074,
                         58.8,	1.80952027030173,
                         58.7,	1.80793516286139,
                         58.6,	1.80634792278366,
                         58.5,	1.80475854142815,
                         58.4,	1.80316701014012,
                         58.3,	1.80157332025053,
                         58.2,	1.79997746307601,
                         58.1,	1.79837942991883,
                         58,	1.79677921206698,
                         57.9,	1.79517680079409,
                         57.8,	1.79357218735948,
                         57.7,	1.79196536300812,
                         57.6,	1.79035631897068,
                         57.5,	1.78874504646348,
                         57.4,	1.78713153668853,
                         57.3,	1.78551578083351,
                         57.2,	1.78389777007175,
                         57.1,	1.78227749556229,
                         57,	1.78065494844981,
                         56.9,	1.77903011986468,
                         56.8,	1.77740300092293,
                         56.7,	1.77577358272629,
                         56.6,	1.77414185636213,
                         56.5,	1.7725078129035,
                         56.4,	1.77087144340914,
                         56.3,	1.76923273892344,
                         56.2,	1.76759169047649,
                         56.1,	1.76594828908402,
                         56,	1.76430252574746,
                         55.9,	1.7626543914539,
                         55.8,	1.76100387717609,
                         55.7,	1.75935097387249,
                         55.6,	1.75769567248719,
                         55.5,	1.75603796394998,
                         55.4,	1.75437783917631,
                         55.3,	1.75271528906732,
                         55.2,	1.75105030450979,
                         55.1,	1.7493828763762,
                         55,	1.74771299552471,
                         54.9,	1.74604065279911,
                         54.8,	1.74436583902891,
                         54.7,	1.74268854502927,
                         54.6,	1.74100876160102,
                         54.5,	1.73932647953067,
                         54.4,	1.7376416895904,
                         54.3,	1.73595438253806,
                         54.2,	1.73426454911718,
                         54.1,	1.73257218005696,
                         54,	1.73087726607227,
                         53.9,	1.72917979786365,
                         53.8,	1.72747976611731,
                         53.7,	1.72577716150515,
                         53.6,	1.72407197468473,
                         53.5,	1.72236419629928,
                         53.4,	1.7206538169777,
                         53.3,	1.71894082733458,
                         53.2,	1.71722521797017,
                         53.1,	1.71550697947039,
                         53,	1.71378610240683,
                         52.9,	1.71206257733678,
                         52.8,	1.71033639480316,
                         52.7,	1.7086075453346,
                         52.6,	1.70687601944538,
                         52.5,	1.70514180763546,
                         52.4,	1.70340490039048,
                         52.3,	1.70166528818173,
                         52.2,	1.6999229614662,
                         52.1,	1.69817791068653,
                         52,	1.69643012627105,
                         51.9,	1.69467959863375,
                         51.8,	1.69292631817431,
                         51.7,	1.69117027527806,
                         51.6,	1.68941146031601,
                         51.5,	1.68764986364486,
                         51.4,	1.68588547560695,
                         51.3,	1.68411828653032,
                         51.2,	1.68234828672868,
                         51.1,	1.6805754665014,
                         51,	1.67879981613352,
                         50.9,	1.67702132589577,
                         50.8,	1.67523998604455,
                         50.7,	1.67345578682191,
                         50.6,	1.67166871845561,
                         50.5,	1.66987877115904,
                         50.4,	1.6680859351313,
                         50.3,	1.66629020055714,
                         50.2,	1.66449155760699,
                         50.1,	1.66268999643696,
                         50,	1.66088550718881,
                         49.9,	1.65907807998999,
                         49.8,	1.65726770495363,
                         49.7,	1.65545437217852,
                         49.6,	1.65363807174912,
                         49.5,	1.65181879373556,
                         49.4,	1.64999652819367,
                         49.3,	1.64817126516492,
                         49.2,	1.64634299467647,
                         49.1,	1.64451170674114,
                         49,	1.64267739135744,
                         48.9,	1.64084003850954,
                         48.8,	1.63899963816728,
                         48.7,	1.63715618028619,
                         48.6,	1.63530965480745,
                         48.5,	1.63346005165792,
                         48.4,	1.63160736075016,
                         48.3,	1.62975157198235,
                         48.2,	1.62789267523839,
                         48.1,	1.62603066038783,
                         48,	1.62416551728589,
                         47.9,	1.62229723577348,
                         47.8,	1.62042580567716,
                         47.7,	1.61855121680919,
                         47.6,	1.61667345896746,
                         47.5,	1.61479252193559,
                         47.4,	1.61290839548282,
                         47.3,	1.6110210693641,
                         47.2,	1.60913053332003,
                         47.1,	1.60723677707688,
                         47,	1.60533979034662,
                         46.9,	1.60343956282687,
                         46.8,	1.60153608420092,
                         46.7,	1.59962934413775,
                         46.6,	1.597719332292,
                         46.5,	1.59580603830398,
                         46.4,	1.59388945179968,
                         46.3,	1.59196956239077,
                         46.2,	1.59004635967457,
                         46.1,	1.5881198332341,
                         46,	1.58618997263802,
                         45.9,	1.5842567674407,
                         45.8,	1.58232020718215,
                         45.7,	1.58038028138808,
                         45.6,	1.57843697956984,
                         45.5,	1.57649029122448,
                         45.4,	1.57454020583472,
                         45.3,	1.57258671286895,
                         45.2,	1.57062980178121,
                         45.1,	1.56866946201125,
                         45,	1.56670568298446,
                         44.9,	1.56473845411193,
                         44.8,	1.56276776479041,
                         44.7,	1.56079360440231,
                         44.6,	1.55881596231573,
                         44.5,	1.55683482788444,
                         44.4,	1.55485019044788,
                         44.3,	1.55286203933116,
                         44.2,	1.55087036384507,
                         44.1,	1.54887515328606,
                         44,	1.54687639693626,
                         43.9,	1.54487408406348,
                         43.8,	1.5428682039212,
                         43.7,	1.54085874574856,
                         43.6,	1.53884569877038,
                         43.5,	1.53682905219715,
                         43.4,	1.53480879522505,
                         43.3,	1.5327849170359,
                         43.2,	1.53075740679723,
                         43.1,	1.52872625366221,
                         43,	1.5266914467697,
                         42.9,	1.52465297524423,
                         42.8,	1.52261082819601,
                         42.7,	1.5205649947209,
                         42.6,	1.51851546390045,
                         42.5,	1.51646222480188,
                         42.4,	1.51440526647809,
                         42.3,	1.51234457796763,
                         42.2,	1.51028014829475,
                         42.1,	1.50821196646936,
                         42,	1.50614002148703,
                         41.9,	1.50406430232902,
                         41.8,	1.50198479796226,
                         41.7,	1.49990149733936,
                         41.6,	1.49781438939857,
                         41.5,	1.49572346306385,
                         41.4,	1.49362870724482,
                         41.3,	1.49153011083676,
                         41.2,	1.48942766272064,
                         41.1,	1.4873213517631,
                         41,	1.48521116681644,
                         40.9,	1.48309709671864,
                         40.8,	1.48097913029336,
                         40.7,	1.47885725634992,
                         40.6,	1.47673146368333,
                         40.5,	1.47460174107424,
                         40.4,	1.47246807728902,
                         40.3,	1.47033046107967,
                         40.2,	1.46818888118387,
                         40.1,	1.46604332632501,
                         40,	1.4638937852121,
                         39.9,	1.46174024653985,
                         39.8,	1.45958269898865,
                         39.7,	1.45742113122455,
                         39.6,	1.45525553189927,
                         39.5,	1.4530858896502,
                         39.4,	1.45091219310042,
                         39.3,	1.44873443085868,
                         39.2,	1.44655259151937,
                         39.1,	1.4443666636626,
                         39,	1.44217663585413,
                         38.9,	1.43998249664537,
                         38.8,	1.43778423457345,
                         38.7,	1.43558183816114,
                         38.6,	1.43337529591689,
                         38.5,	1.43116459633482,
                         38.4,	1.42894972789473,
                         38.3,	1.42673067906208,
                         38.2,	1.42450743828803,
                         38.1,	1.42227999400937,
                         38,	1.4200483346486,
                         37.9,	1.41781244861388,
                         37.8,	1.41557232429904,
                         37.7,	1.41332795008357,
                         37.6,	1.41107931433267,
                         37.5,	1.40882640539717,
                         37.4,	1.4065692116136,
                         37.3,	1.40430772130415,
                         37.2,	1.40204192277669,
                         37.1,	1.39977180432476,
                         37,	1.39749735422757,
                         36.9,	1.39521856075001,
                         36.8,	1.39293541214263,
                         36.7,	1.39064789664167,
                         36.6,	1.38835600246902,
                         36.5,	1.38605971783226,
                         36.4,	1.38375903092464,
                         36.3,	1.38145392992507,
                         36.2,	1.37914440299816,
                         36.1,	1.37683043829417,
                         36,	1.37451202394903,
                         35.9,	1.37218914808436,
                         35.8,	1.36986179880743,
                         35.7,	1.36752996421121,
                         35.6,	1.36519363237433,
                         35.5,	1.36285279136107,
                         35.4,	1.36050742922143,
                         35.3,	1.35815753399104,
                         35.2,	1.35580309369122,
                         35.1,	1.35344409632897,
                         35,	1.35108052989694,
                         34.9,	1.34871238237348,
                         34.8,	1.34633964172259,
                         34.7,	1.34396229589396,
                         34.6,	1.34158033282294,
                         34.5,	1.33919374043056,
                         34.4,	1.33680250662351,
                         34.3,	1.33440661929417,
                         34.2,	1.33200606632059,
                         34.1,	1.32960083556647,
                         34,	1.32719091488122,
                         33.9,	1.32477629209989,
                         33.8,	1.32235695504322,
                         33.7,	1.31993289151762,
                         33.6,	1.31750408931516,
                         33.5,	1.31507053621361,
                         33.4,	1.31263221997637,
                         33.3,	1.31018912835256,
                         33.2,	1.30774124907695,
                         33.1,	1.30528856986997,
                         33,	1.30283107843775,
                         32.9,	1.30036876247207,
                         32.8,	1.29790160965039,
                         32.7,	1.29542960763585,
                         32.6,	1.29295274407725,
                         32.5,	1.29047100660908,
                         32.4,	1.28798438285147,
                         32.3,	1.28549286041027,
                         32.2,	1.28299642687696,
                         32.1,	1.28049506982871,
                         32,	1.27798877682837,
                         31.9,	1.27547753542445,
                         31.8,	1.27296133315113,
                         31.7,	1.27044015752829,
                         31.6,	1.26791399606144,
                         31.5,	1.26538283624179,
                         31.4,	1.26284666554623,
                         31.3,	1.2603054714373,
                         31.2,	1.25775924136322,
                         31.1,	1.25520796275789,
                         31,	1.25265162304088,
                         30.9,	1.25009020961742,
                         30.8,	1.24752370987844,
                         30.7,	1.24495211120051,
                         30.6,	1.2423754009459,
                         30.5,	1.23979356646253,
                         30.4,	1.23720659508401,
                         30.3,	1.23461447412962,
                         30.2,	1.2320171909043,
                         30.1,	1.22941473269867,
                         30,	1.22680708678903,
                         29.9,	1.22419424043735,
                         29.8,	1.22157618089126,
                         29.7,	1.21895289538407,
                         29.6,	1.21632437113478,
                         29.5,	1.21369059534803,
                         29.4,	1.21105155521415,
                         29.3,	1.20840723790916,
                         29.2,	1.20575763059472,
                         29.1,	1.20310272041817,
                         29,	1.20044249451255,
                         28.9,	1.19777693999653,
                         28.8,	1.1951060439745,
                         28.7,	1.19242979353647,
                         28.6,	1.18974817575818,
                         28.5,	1.18706117770098,
                         28.4,	1.18436878641195,
                         28.3,	1.18167098892381,
                         28.2,	1.17896777225497,
                         28.1,	1.17625912340948,
                         28,	1.17354502937711,
                         27.9,	1.17082547713326,
                         27.8,	1.16810045363903,
                         27.7,	1.16536994584118,
                         27.6,	1.16263394067216,
                         27.5,	1.15989242505006,
                         27.4,	1.15714538587866,
                         27.3,	1.15439281004743,
                         27.2,	1.15163468443149,
                         27.1,	1.14887099589164,
                         27,	1.14610173127434,
                         26.9,	1.14332687741175,
                         26.8,	1.14054642112169,
                         26.7,	1.13776034920763,
                         26.6,	1.13496864845874,
                         26.5,	1.13217130564986,
                         26.4,	1.12936830754149,
                         26.3,	1.12655964087982,
                         26.2,	1.1237452923967,
                         26.1,	1.12092524880964,
                         26,	1.11809949682186,
                         25.9,	1.11526802312221,
                         25.8,	1.11243081438525,
                         25.7,	1.10958785727119,
                         25.6,	1.10673913842591,
                         25.5,	1.10388464448097,
                         25.4,	1.10102436205362,
                         25.3,	1.09815827774675,
                         25.2,	1.09528637814895,
                         25.1,	1.09240864983446,
                         25,	1.08952507936321,
                         24.9,	1.08663565328079,
                         24.8,	1.08374035811848,
                         24.7,	1.08083918039321,
                         24.6,	1.0779321066076,
                         24.5,	1.07501912324994,
                         24.4,	1.07210021679418,
                         24.3,	1.06917537369995,
                         24.2,	1.06624458041257,
                         24.1,	1.06330782336301,
                         24,	1.06036508896791,
                         23.9,	1.0574163636296,
                         23.8,	1.05446163373607,
                         23.7,	1.051500885661,
                         23.6,	1.04853410576372,
                         23.5,	1.04556128038924,
                         23.4,	1.04258239586825,
                         23.3,	1.03959743851711,
                         23.2,	1.03660639463785,
                         23.1,	1.03360925051816,
                         23,	1.03060599243143,
                         22.9,	1.02759660663671,
                         22.8,	1.02458107937871,
                         22.7,	1.02155939688782,
                         22.6,	1.01853154538012,
                         22.5,	1.01549751105735,
                         22.4,	1.0124572801069,
                         22.3,	1.00941083870188,
                         22.2,	1.00635817300102,
                         22.1,	1.00329926914877,
                         22,	1.00023411327522,
                         21.9,	0.99716269149615,
                         21.8,	0.994084989913004,
                         21.7,	0.991000994612901,
                         21.6,	0.987910691668634,
                         21.5,	0.984814067138667,
                         21.4,	0.981711107067136,
                         21.3,	0.978601797483853,
                         21.2,	0.975486124404298,
                         21.1,	0.972364073829627,
                         21,	0.969235631746667,
                         20.9,	0.966100784127919,
                         20.8,	0.962959516931554,
                         20.7,	0.959811816101418,
                         20.6,	0.956657667567029,
                         20.5,	0.953497057243578,
                         20.4,	0.950329971031927,
                         20.3,	0.947156394818611,
                         20.2,	0.94397631447584,
                         20.1,	0.940789715861494,
                         20,	0.937596584819127,
                         19.9,	0.934396907177963,
                         19.8,	0.931190668752903,
                         19.7,	0.927977855344517,
                         19.6,	0.924758452739048,
                         19.5,	0.921532446708415,
                         19.4,	0.918299823010204,
                         19.3,	0.915060567387678,
                         19.2,	0.911814665569771,
                         19.1,	0.90856210327109,
                         19,	0.905302866191915,
                         18.9,	0.902036940018196,
                         18.8,	0.898764310421559,
                         18.7,	0.895484963059301,
                         18.6,	0.892198883574391,
                         18.5,	0.888906057595472,
                         18.4,	0.885606470736859,
                         18.3,	0.88230010859854,
                         18.2,	0.878986956766174,
                         18.1,	0.875667000811094,
                         18,	0.872340226290306,
                         17.9,	0.869006618746487,
                         17.8,	0.865666163707988,
                         17.7,	0.862318846688832,
                         17.6,	0.858964653188715,
                         17.5,	0.855603568693006,
                         17.4,	0.852235578672744,
                         17.3,	0.848860668584643,
                         17.2,	0.84547882387109,
                         17.1,	0.842090029960144,
                         17,	0.838694272265534,
                         16.9,	0.835291536186667,
                         16.8,	0.831881807108617,
                         16.7,	0.828465070402134,
                         16.6,	0.82504131142364,
                         16.5,	0.821610515515228,
                         16.4,	0.818172668004667,
                         16.3,	0.814727754205394,
                         16.2,	0.811275759416523,
                         16.1,	0.807816668922837,
                         16,	0.804350467994795,
                         15.9,	0.800877141888526,
                         15.8,	0.797396675845832,
                         15.7,	0.793909055094188,
                         15.6,	0.790414264846742,
                         15.5,	0.786912290302315,
                         15.4,	0.783403116645399,
                         15.3,	0.779886729046159,
                         15.2,	0.776363112660433,
                         15.1,	0.772832252629733,
                         15,	0.769294134081241,
                         14.9,	0.765748742127813,
                         14.8,	0.762196061867978,
                         14.7,	0.758636078385935,
                         14.6,	0.755068776751561,
                         14.5,	0.751494142020399,
                         14.4,	0.747912159233669,
                         14.3,	0.744322813418263,
                         14.2,	0.740726089586744,
                         14.1,	0.737121972737348,
                         14,	0.733510447853986,
                         13.9,	0.729891499906239,
                         13.8,	0.726265113849361,
                         13.7,	0.722631274624279,
                         13.6,	0.718989967157592,
                         13.5,	0.715341176361573,
                         13.4,	0.711684887134167,
                         13.3,	0.708021084358991,
                         13.2,	0.704349752905335,
                         13.1,	0.70067087762816,
                         13,	0.696984443368104,
                         12.9,	0.693290434951472,
                         12.8,	0.689588837190246,
                         12.7,	0.685879634882078,
                         12.6,	0.682162812810294,
                         12.5,	0.678438355743892,
                         12.4,	0.674706248437543,
                         12.3,	0.670966475631589,
                         12.2,	0.667219022052047,
                         12.1,	0.663463872410606,
                         12,	0.659701011404626,
                         11.9,	0.655930423717141,
                         11.8,	0.652152094016858,
                         11.7,	0.648366006958154,
                         11.6,	0.644572147181082,
                         11.5,	0.640770499311366,
                         11.4,	0.636961047960403,
                         11.3,	0.633143777725261,
                         11.2,	0.629318673188682,
                         11.1,	0.625485718919082,
                         11,	0.621644899470546,
                         10.9,	0.617796199382835,
                         10.8,	0.613939603181381,
                         10.7,	0.610075095377288,
                         10.6,	0.606202660467334,
                         10.5,	0.60232228293397,
                         10.4,	0.598433947245317,
                         10.3,	0.594537637855171,
                         10.2,	0.590633339203,
                         10.1,	0.586721035713944,
                         10,	0.582800711798816,
                         9.9,	0.578872351854102,
                         9.8,	0.574935940261959,
                         9.7,	0.57099146139022,
                         9.6,	0.567038899592386,
                         9.5,	0.563078239207634,
                         9.4,	0.559109464560813,
                         9.3,	0.555132559962444,
                         9.2,	0.55114750970872,
                         9.1,	0.547154298081509,
                         9,	0.543152909348348,
                         8.9,	0.539143327762449,
                         8.8,	0.535125537562697,
                         8.7,	0.531099522973649,
                         8.6,	0.527065268205533,
                         8.5,	0.523022757454251,
                         8.4,	0.518971974901379,
                         8.3,	0.514912904714163,
                         8.2,	0.510845531045523,
                         8.1,	0.506769838034051,
                         8,	0.502685809804013,
                         7.9,	0.498593430465345,
                         7.8,	0.494492684113658,
                         7.7,	0.490383554830235,
                         7.6,	0.48626602668203,
                         7.5,	0.482140083721672,
                         7.4,	0.478005709987462,
                         7.3,	0.473862889503372,
                         7.2,	0.469711606279048,
                         7.1,	0.465551844309807,
                         7,	0.461383587576643,
                         6.9,	0.457206820046217,
                         6.8,	0.453021525670866,
                         6.7,	0.448827688388597,
                         6.6,	0.444625292123094,
                         6.5,	0.440414320783709,
                         6.4,	0.436194758265469,
                         6.3,	0.431966588449073,
                         6.2,	0.427729795200893,
                         6.1,	0.423484362372972,
                         6,	0.419230273803029,
                         5.9,	0.414967513314451,
                         5.8,	0.410696064716302,
                         5.7,	0.406415911803315,
                         5.6,	0.402127038355899,
                         5.5,	0.397829428140132,
                         5.4,	0.393523064907767,
                         5.3,	0.38920793239623,
                         5.2,	0.384884014328618,
                         5.1,	0.3805512944137,
                         5,	0.376209756345921,
                         4.9,	0.371859383805395,
                         4.8,	0.36750016045791,
                         4.7,	0.363132069954927,
                         4.6,	0.358755095933578,
                         4.5,	0.354369222016671,
                         4.4,	0.349974431812683,
                         4.3,	0.345570708915765,
                         4.2,	0.341158036905741,
                         4.1,	0.336736399348106,
                         4,	0.33230577979403,
                         3.9,	0.327866161780354,
                         3.8,	0.323417528829592,
                         3.7,	0.318959864449931,
                         3.6,	0.314493152135228,
                         3.5,	0.310017375365018,
                         3.4,	0.305532517604503,
                         3.3,	0.30103856230456,
                         3.2,	0.29653549290174,
                         3.1,	0.292023292818264,
                         3,	0.287501945462027,
                         2.9,	0.282971434226595,
                         2.8,	0.278431742491211,
                         2.7,	0.273882853620784,
                         2.6,	0.269324750965902,
                         2.5,	0.264757417862821,
                         2.4,	0.260180837633472,
                         2.3,	0.255594993585458,
                         2.2,	0.250999869012053,
                         2.1,	0.246395447192207,
                         2,	0.241781711390539,
                         1.9,	0.237158644857345,
                         1.8,	0.232526230828587,
                         1.7,	0.227884452525906,
                         1.6,	0.223233293156613,
                         1.5,	0.218572735913691,
                         1.4,	0.213902763975797,
                         1.3,	0.209223360507259,
                         1.2,	0.204534508658078,
                         1.1,	0.199836191563929,
                         1,	0.195128392346159,
                         0.900000000000002,	0.190411094111786,
                         0.800000000000004,	0.185684279953503,
                         0.700000000000003,	0.180947932949673,
                         0.600000000000001,	0.176202036164335,
                         0.500000000000004,	0.171446572647197,
                         0.400000000000002,	0.166681525433642,
                         0.300000000000004,	0.161906877544724,
                         0.200000000000003,	0.157122611987171,
                         0.100000000000001,	0.152328711753384,
                         0,	0.147525159821433,
                         -0.0999999999999979,	0.142711939155066,
                         -0.199999999999996,	0.137889032703699,
                         -0.299999999999997,	0.133056423402423,
                         -0.399999999999999,	0.128214094172001,
                         -0.499999999999996,	0.123362027918868,
                         -0.599999999999998,	0.118500207535133,
                         -0.699999999999996,	0.113628615898576,
                         -0.799999999999997,	0.108747235872651,
                         -0.899999999999999,	0.103856050306483,
                         -0.999999999999996,	0.0989550420348722,
                         -1.1,	0.094044193878289,
                         -1.2,	0.0891234886428763,
                         -1.3,	0.0841929091204513,
                         -1.4,	0.0792524380885026,
                         -1.5,	0.0743020583101921,
                         -1.6,	0.0693417525343538,
                         -1.7,	0.0643715034954942,
                         -1.8,	0.0593912939137925,
                         -1.9,	0.0544011064951008,
                         -2,	0.0494009239309441,
                         -2.1,	0.0443907288985191,
                         -2.2,	0.0393705040606952,
                         -2.3,	0.0343402320660151,
                         -2.4,	0.0292998955486938,
                         -2.5,	0.0242494771286182,
                         -2.6,	0.0191889594113495,
                         -2.7,	0.0141183249881187,
                         -2.8,	0.00903755643583263,
                         -2.9,	0.00394663631706862,
                         -3,	-0.00115445281992325,
                         -3.1,	-0.00626572844121883,
                         -3.2,	-0.0113872080272241,
                         -3.3,	-0.0165189090726691,
                         -3.4,	-0.0216608490866142,
                         -3.5,	-0.0268130455924455,
                         -3.6,	-0.0319755161278764,
                         -3.7,	-0.0371482782449497,
                         -3.8,	-0.0423313495100324,
                         -3.9,	-0.0475247475038219,
                         -4,	-0.0527284898213416,
                         -4.1,	-0.0579425940719415,
                         -4.2,	-0.0631670778793017,
                         -4.3,	-0.0684019588814262,
                         -4.4,	-0.0736472547306494,
                         -4.5,	-0.0789029830936314,
                         -4.6,	-0.08416916165136,
                         -4.7,	-0.0894458080991515,
                         -4.8,	-0.0947329401466474,
                         -4.9,	-0.100030575517819,
                         -5,	-0.105338731950963,
                         -5.1,	-0.110657427198705,
                         -5.2,	-0.115986679027997,
                         -5.3,	-0.12132650522012,
                         -5.4,	-0.12667692357068,
                         -5.5,	-0.132037951889612,
                         -5.6,	-0.137409608001177,
                         -5.7,	-0.142791909743967,
                         -5.8,	-0.148184874970897,
                         -5.9,	-0.153588521549211,
                         -6,	-0.159002867360481,
                         -6.1,	-0.164427930300606,
                         -6.2,	-0.169863728279813,
                         -6.3,	-0.175310279222656,
                         -6.4,	-0.180767601068015,
                         -6.5,	-0.186235711769101,
                         -6.6,	-0.191714629293446,
                         -6.7,	-0.197204371622918,
                         -6.8,	-0.202704956753705,
                         -6.9,	-0.208216402696327,
                         -7,	-0.213738727475628,
                         -7.1,	-0.219271949130782,
                         -7.2,	-0.224816085715289,
                         -7.3,	-0.230371155296979,
                         -7.4,	-0.235937175958004,
                         -7.5,	-0.241514165794849,
                         -7.6,	-0.247102142918324,
                         -7.7,	-0.252701125453565,
                         -7.8,	-0.258311131540038,
                         -7.9,	-0.263932179331536,
                         -8,	-0.269564286996177,
                         -8.1,	-0.27520747271641,
                         -8.2,	-0.280861754689008,
                         -8.3,	-0.286527151125074,
                         -8.4,	-0.292203680250036,
                         -8.5,	-0.297891360303653,
                         -8.6,	-0.303590209540006,
                         -8.7,	-0.30930024622751,
                         -8.8,	-0.315021488648902,
                         -8.9,	-0.320753955101248,
                         -9,	-0.326497663895943,
                         -9.1,	-0.332252633358707,
                         -9.2,	-0.33801888182959,
                         -9.3,	-0.343796427662967,
                         -9.4,	-0.349585289227541,
                         -9.5,	-0.355385484906344,
                         -9.6,	-0.361197033096733,
                         -9.7,	-0.367019952210394,
                         -9.8,	-0.372854260673341,
                         -9.9,	-0.378699976925913,
                         -10,	-0.384557119422778,
                         -10.1,	-0.390425706632932,
                         -10.2,	-0.396305757039697,
                         -10.3,	-0.402197289140724,
                         -10.4,	-0.408100321447989,
                         -10.5,	-0.414014872487797,
                         -10.6,	-0.419940960800781,
                         -10.7,	-0.4258786049419,
                         -10.8,	-0.431827823480442,
                         -10.9,	-0.437788635000021,
                         -11,	-0.443761058098578,
                         -11.1,	-0.449745111388383,
                         -11.2,	-0.455740813496033,
                         -11.3,	-0.461748183062451,
                         -11.4,	-0.46776723874289,
                         -11.5,	-0.473797999206927,
                         -11.6,	-0.479840483138469,
                         -11.7,	-0.485894709235751,
                         -11.8,	-0.491960696211332,
                         -11.9,	-0.498038462792102,
                         -12,	-0.504128027719277,
                         -12.1,	-0.510229409748398,
                         -12.2,	-0.516342627649339,
                         -12.3,	-0.522467700206295,
                         -12.4,	-0.528604646217794,
                         -12.5,	-0.534753484496688,
                         -12.6,	-0.540914233870157,
                         -12.7,	-0.547086913179708,
                         -12.8,	-0.553271541281178,
                         -12.9,	-0.559468137044728,
                         -13,	-0.565676719354849,
                         -13.1,	-0.571897307110357,
                         -13.2,	-0.578129919224399,
                         -13.3,	-0.584374574624444,
                         -13.4,	-0.590631292252294,
                         -13.5,	-0.596900091064075,
                         -13.6,	-0.603180990030242,
                         -13.7,	-0.609474008135576,
                         -13.8,	-0.615779164379186,
                         -13.9,	-0.622096477774509,
                         -14,	-0.62842596734931,
                         -14.1,	-0.634767652145678,
                         -14.2,	-0.641121551220035,
                         -14.3,	-0.647487683643124,
                         -14.4,	-0.65386606850002,
                         -14.5,	-0.660256724890124,
                         -14.6,	-0.666659671927164,
                         -14.7,	-0.673074928739197,
                         -14.8,	-0.679502514468604,
                         -14.9,	-0.685942448272098,
                         -15,	-0.692394749320716,
                         -15.1,	-0.698859436799822,
                         -15.2,	-0.705336529909111,
                         -15.3,	-0.711826047862602,
                         -15.4,	-0.718328009888644,
                         -15.5,	-0.72484243522991,
                         -15.6,	-0.731369343143403,
                         -15.7,	-0.737908752900455,
                         -15.8,	-0.74446068378672,
                         -15.9,	-0.751025155102185,
                         -16,	-0.757602186161161,
                         -16.1,	-0.764191796292287,
                         -16.2,	-0.770794004838532,
                         -16.3,	-0.777408831157188,
                         -16.4,	-0.784036294619877,
                         -16.5,	-0.790676414612549,
                         -16.6,	-0.79732921053548,
                         -16.7,	-0.803994701803274,
                         -16.8,	-0.810672907844862,
                         -16.9,	-0.817363848103502,
                         -17,	-0.824067542036783,
                         -17.1,	-0.830784009116614,
                         -17.2,	-0.837513268829241,
                         -17.3,	-0.844255340675228,
                         -17.4,	-0.851010244169472,
                         -17.5,	-0.857777998841198,
                         -17.6,	-0.864558624233953,
                         -17.7,	-0.871352139905619,
                         -17.8,	-0.878158565428397,
                         -17.9,	-0.884977920388824,
                         -18,	-0.891810224387757,
                         -18.1,	-0.898655497040384,
                         -18.2,	-0.905513757976222,
                         -18.3,	-0.912385026839111,
                         -18.4,	-0.919269323287222,
                         -18.5,	-0.926166666993052,
                         -18.6,	-0.933077077643425,
                         -18.7,	-0.940000574939494,
                         -18.8,	-0.946937178596736,
                         -18.9,	-0.953886908344961,
                         -19,	-0.960849783928301,
                         -19.1,	-0.967825825105217,
                         -19.2,	-0.974815051648501,
                         -19.3,	-0.981817483345267,
                         -19.4,	-0.988833139996959,
                         -19.5,	-0.99586204141935,
                         -19.6,	-1.00290420744253,
                         -19.7,	-1.00995965791094,
                         -19.8,	-1.01702841268333,
                         -19.9,	-1.02411049163277,
                         -20,	-1.03120591464667,
                         -20.1,	-1.03831470162677,
                         -20.2,	-1.04543687248914,
                         -20.3,	-1.05257244716416,
                         -20.4,	-1.05972144559656,
                         -20.5,	-1.06688388774537,
                         -20.6,	-1.07405979358396,
                         -20.7,	-1.08124918310005,
                         -20.8,	-1.08845207629566,
                         -20.9,	-1.09566849318713
                        };
    const int mapSize = sizeof(map) / sizeof(map[0]);
    int range = -1;
    for (int i = 0; i < mapSize - 2; i += 2) {
        if (dz >= map[i + 2] && dz < map[i]) {
            range = i;
            break;
        }
    }
    if (range == -1)
        return 1000;
    float rangeSpan = map[range] - map[range + 2];
    float dist = (dz - map[range + 2]) / rangeSpan;
    float valueSpan = map[range + 1] - map[range + 3];
    return map[range + 3] + valueSpan * dist;
}

void Automator::checkWorkingState()
{
    bool working = m_lastdzValid && m_mcConnected && m_lastCoordsValid && m_enabled && m_cameraConnected;
    if (working) {
        m_working = true;
        m_state = m_cutModeEnabled ? AutoCutting : AutoEngraving;
        emit stateChanged(m_state);
    } else {
        m_working = false;
        m_state = Disabled;
        emit stateChanged(m_state);
    }
}

void Automator::m_scanSnapshot()
{
    float compensated = compensate(m_lastdz);
    if (compensated > 10) {
        m_message = "No entry in comp table";
        emit messageChanged();
        //emit continueScan();
    } else {
        SurfacePoint point;
        point.x = qRound(m_mcs_x-605);
        point.y = qRound(m_mcs_y);
        point.z = compensated;
        m_surfaceModel->addPointWithoutNotify(point);
        m_message = QString("Z: %1").arg(compensated);
        emit messageChanged();
        qDebug() << m_message;

        /*SPLINTER::DenseVector x(2);
        float y;

        x(0) = qRound(m_mcs_x-605);
        x(1) = qRound(m_mcs_y);
        y = compensated;

        m_samples.addSample(x,y);*/

        emit continueScan();
    }
}

float Automator::minPower() const
{
    return m_minPower;
}

void Automator::setMinPower(float minPower)
{
    m_minPower = minPower;
}

float Automator::lastSentPower() const
{
    return m_lastSentPower;
}

void Automator::scanSurface(int width, int height, int step)
{

    /*SurfacePoint point;

    for (int i=0; i<=height/step; i++)
    {
        for (int j=1; j<=width/step; j++)
            if (i%2)
            {
                point.x = width-step*j;
                point.y = i;
                point.z = i+width-step*j;
                m_surfaceModel->addPointWithoutNotify(point);
            }
            else
            {
                point.x = step*j;
                point.y = i;
                point.z = i+step*j;
                m_surfaceModel->addPointWithoutNotify(point);
            }
    }*/

    m_scanWidth = width;
    m_scanHeight = height;

    QFile scanGCode("scanGCode.ngc");
    if (scanGCode.open(QFile::WriteOnly | QFile::Truncate)) {
        QTextStream out(&scanGCode);

        out << "M220 S100\nM204 S600\nG90 G0 X0 Y0 F10000\n";

        for (int i=0; i<=height/step; i++)
        {
            out << QString("G0 Y%1\nM25\n").arg(step*i);

            for (int j=1; j<=width/step; j++)
                if (i%2)
                    out << QString("G0 X%1\nM25\n").arg(width-step*j);
                else
                    out << QString("G0 X%1\nM25\n").arg(step*j);
        }

        out << "G0 X0 Y0\n";
    }

    emit startScan(QUrl("file:scanGCode.ngc"));


    m_state = Scanning;
    emit stateChanged(m_state);
}

void Automator::approveScan()
{
    m_scanComplited = false;
    emit scanStateChanged();

    //todo
}

SurfaceModel *Automator::surfaceModel() const
{
    return m_surfaceModel;
}

void Automator::clearSurface() const
{
    m_surfaceModel->removeAll();
}

Automator::State Automator::state() const
{
    return m_state;
}

float Automator::maxPower() const
{
    return m_maxPower;
}

void Automator::setMaxPower(float maxPower)
{
    m_maxPower = maxPower;
}

bool Automator::autosendPower() const
{
    return m_autosendPower;
}

void Automator::setAutosendPower(bool autosendPower)
{
    m_autosendPower = autosendPower;
}

bool Automator::cutModeEnabled() const
{
    return m_cutModeEnabled;
}

void Automator::setCutModeEnabled(bool cutMode)
{
    m_cutModeEnabled = cutMode;
}

bool Automator::scanComplited() const
{
    return m_scanComplited;
}

bool Automator::enabled() const
{
    return m_enabled;
}

void Automator::setEnabled(bool enabled)
{
    m_enabled = enabled;
    emit enabledChanged();
    checkWorkingState();
}

QString Automator::message() const
{
    return m_message;
}
